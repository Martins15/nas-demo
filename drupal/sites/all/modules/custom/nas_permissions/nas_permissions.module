<?php

/**
 * @file
 * Define custom permissions.
 */

/**
 * Implements hook_permission().
 */
function nas_permissions_permission() {
  return array(
    'pane in the news edit' =>  array(
      'title' => t('Bird Guide. In The News pane edit'),
    ),
    'fpp bird guide pane edit' =>  array(
      'title' => t('Birds Landing page. The Audubon Bird Guide pane edit'),
    ),
    'featured article pane edit' =>  array(
      'title' => t('News Page. Featured Article edit'),
    ),
    'bird landing featured pane edit' =>  array(
      'title' => t('Bird Landing featured pane edit'),
    ),
    'bird guide featured pane edit' =>  array(
      'title' => t('Bird Guide featured panes edit'),
    ),
    'frontpage featured pane edit' =>  array(
      'title' => t('Frontpage featured panes edit'),
    ),
    'panelizer layout node settings' =>  array(
      'title' => t('Access to panelizer layout node settings'),
    ),
  );
}


/**
 * Implements hook_form_alter().
 */
function nas_permissions_form_node_form_alter(&$form, &$form_state, $form_id) {
  $node_type = $form['#node']->type;

  // Check node type and presence panelizer settings
  if ($node_type != 'article' || !isset($form['panelizer'])) return;

  // Alter panelizer access
  $form['panelizer']['#access'] = user_access('panelizer layout node settings');
}
